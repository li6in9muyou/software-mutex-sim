(function(){"use strict";const U={deserialize(e){return Object.assign(Error(e.message),{name:e.name,stack:e.stack})},serialize(e){return{__error_marker:"$$error",message:e.message,name:e.name,stack:e.stack}}},_e=e=>e&&typeof e=="object"&&"__error_marker"in e&&e.__error_marker==="$$error";let ee={deserialize(e){return _e(e)?U.deserialize(e):e},serialize(e){return e instanceof Error?U.serialize(e):e}};function te(e){return ee.deserialize(e)}function E(e){return ee.serialize(e)}function ve(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Fe(e){var t=e.default;if(typeof t=="function"){var n=function(){return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}),n}var ne={exports:{}},V,re;function Se(){if(re)return V;re=1;var e=1e3,t=e*60,n=t*60,r=n*24,s=r*7,o=r*365.25;V=function(i,u){u=u||{};var d=typeof i;if(d==="string"&&i.length>0)return c(i);if(d==="number"&&isFinite(i))return u.long?f(i):a(i);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(i))};function c(i){if(i=String(i),!(i.length>100)){var u=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i);if(!!u){var d=parseFloat(u[1]),g=(u[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"yrs":case"yr":case"y":return d*o;case"weeks":case"week":case"w":return d*s;case"days":case"day":case"d":return d*r;case"hours":case"hour":case"hrs":case"hr":case"h":return d*n;case"minutes":case"minute":case"mins":case"min":case"m":return d*t;case"seconds":case"second":case"secs":case"sec":case"s":return d*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return d;default:return}}}}function a(i){var u=Math.abs(i);return u>=r?Math.round(i/r)+"d":u>=n?Math.round(i/n)+"h":u>=t?Math.round(i/t)+"m":u>=e?Math.round(i/e)+"s":i+"ms"}function f(i){var u=Math.abs(i);return u>=r?l(i,u,r,"day"):u>=n?l(i,u,n,"hour"):u>=t?l(i,u,t,"minute"):u>=e?l(i,u,e,"second"):i+" ms"}function l(i,u,d,g){var T=u>=d*1.5;return Math.round(i/d)+" "+g+(T?"s":"")}return V}function Me(e){n.debug=n,n.default=n,n.coerce=f,n.disable=o,n.enable=s,n.enabled=c,n.humanize=Se(),n.destroy=l,Object.keys(e).forEach(i=>{n[i]=e[i]}),n.names=[],n.skips=[],n.formatters={};function t(i){let u=0;for(let d=0;d<i.length;d++)u=(u<<5)-u+i.charCodeAt(d),u|=0;return n.colors[Math.abs(u)%n.colors.length]}n.selectColor=t;function n(i){let u,d=null,g,T;function h(...b){if(!h.enabled)return;const F=h,y=Number(new Date),O=y-(u||y);F.diff=O,F.prev=u,F.curr=y,u=y,b[0]=n.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let S=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(w,M)=>{if(w==="%%")return"%";S++;const G=n.formatters[M];if(typeof G=="function"){const Lt=b[S];w=G.call(F,Lt),b.splice(S,1),S--}return w}),n.formatArgs.call(F,b),(F.log||n.log).apply(F,b)}return h.namespace=i,h.useColors=n.useColors(),h.color=n.selectColor(i),h.extend=r,h.destroy=n.destroy,Object.defineProperty(h,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(g!==n.namespaces&&(g=n.namespaces,T=n.enabled(i)),T),set:b=>{d=b}}),typeof n.init=="function"&&n.init(h),h}function r(i,u){const d=n(this.namespace+(typeof u>"u"?":":u)+i);return d.log=this.log,d}function s(i){n.save(i),n.namespaces=i,n.names=[],n.skips=[];let u;const d=(typeof i=="string"?i:"").split(/[\s,]+/),g=d.length;for(u=0;u<g;u++)!d[u]||(i=d[u].replace(/\*/g,".*?"),i[0]==="-"?n.skips.push(new RegExp("^"+i.slice(1)+"$")):n.names.push(new RegExp("^"+i+"$")))}function o(){const i=[...n.names.map(a),...n.skips.map(a).map(u=>"-"+u)].join(",");return n.enable(""),i}function c(i){if(i[i.length-1]==="*")return!0;let u,d;for(u=0,d=n.skips.length;u<d;u++)if(n.skips[u].test(i))return!1;for(u=0,d=n.names.length;u<d;u++)if(n.names[u].test(i))return!0;return!1}function a(i){return i.toString().substring(2,i.toString().length-2).replace(/\.\*\?$/,"*")}function f(i){return i instanceof Error?i.stack||i.message:i}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var xe=Me;(function(e,t){t.formatArgs=r,t.save=s,t.load=o,t.useColors=n,t.storage=c(),t.destroy=(()=>{let f=!1;return()=>{f||(f=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(f){if(f[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+f[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const l="color: "+this.color;f.splice(1,0,l,"color: inherit");let i=0,u=0;f[0].replace(/%[a-zA-Z%]/g,d=>{d!=="%%"&&(i++,d==="%c"&&(u=i))}),f.splice(u,0,l)}t.log=console.debug||console.log||(()=>{});function s(f){try{f?t.storage.setItem("debug",f):t.storage.removeItem("debug")}catch{}}function o(){let f;try{f=t.storage.getItem("debug")}catch{}return!f&&typeof process<"u"&&"env"in process&&(f=process.env.DEBUG),f}function c(){try{return localStorage}catch{}}e.exports=xe(t);const{formatters:a}=e.exports;a.j=function(f){try{return JSON.stringify(f)}catch(l){return"[UnexpectedJSONParseError]: "+l.message}}})(ne,ne.exports);var Ee=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function a(i){try{l(r.next(i))}catch(u){c(u)}}function f(i){try{l(r.throw(i))}catch(u){c(u)}}function l(i){i.done?o(i.value):s(i.value).then(a,f)}l((r=r.apply(e,t||[])).next())})};class z{constructor(t){this._baseObserver=t,this._pendingPromises=new Set}complete(){Promise.all(this._pendingPromises).then(()=>this._baseObserver.complete()).catch(t=>this._baseObserver.error(t))}error(t){this._baseObserver.error(t)}schedule(t){const n=Promise.all(this._pendingPromises),r=[],s=c=>r.push(c),o=Promise.resolve().then(()=>Ee(this,void 0,void 0,function*(){yield n,yield t(s),this._pendingPromises.delete(o);for(const c of r)this._baseObserver.next(c)})).catch(c=>{this._pendingPromises.delete(o),this._baseObserver.error(c)});this._pendingPromises.add(o)}}const oe=()=>typeof Symbol=="function",k=e=>oe()&&Boolean(Symbol[e]),B=e=>k(e)?Symbol[e]:"@@"+e;k("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"));const je=B("iterator"),Z=B("observable"),se=B("species");function I(e,t){const n=e[t];if(n!=null){if(typeof n!="function")throw new TypeError(n+" is not a function");return n}}function $(e){let t=e.constructor;return t!==void 0&&(t=t[se],t===null&&(t=void 0)),t!==void 0?t:p}function Te(e){return e instanceof p}function j(e){j.log?j.log(e):setTimeout(()=>{throw e},0)}function R(e){Promise.resolve().then(()=>{try{e()}catch(t){j(t)}})}function ie(e){const t=e._cleanup;if(t!==void 0&&(e._cleanup=void 0,!!t))try{if(typeof t=="function")t();else{const n=I(t,"unsubscribe");n&&n.call(t)}}catch(n){j(n)}}function H(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function Oe(e){const t=e._queue;if(!!t){e._queue=void 0,e._state="ready";for(const n of t)if(ce(e,n.type,n.value),e._state==="closed")break}}function ce(e,t,n){e._state="running";const r=e._observer;try{const s=r?I(r,t):void 0;switch(t){case"next":s&&s.call(r,n);break;case"error":if(H(e),s)s.call(r,n);else throw n;break;case"complete":H(e),s&&s.call(r);break}}catch(s){j(s)}e._state==="closed"?ie(e):e._state==="running"&&(e._state="ready")}function Y(e,t,n){if(e._state!=="closed"){if(e._state==="buffering"){e._queue=e._queue||[],e._queue.push({type:t,value:n});return}if(e._state!=="ready"){e._state="buffering",e._queue=[{type:t,value:n}],R(()=>Oe(e));return}ce(e,t,n)}}class ke{constructor(t,n){this._cleanup=void 0,this._observer=t,this._queue=void 0,this._state="initializing";const r=new $e(this);try{this._cleanup=n.call(void 0,r)}catch(s){r.error(s)}this._state==="initializing"&&(this._state="ready")}get closed(){return this._state==="closed"}unsubscribe(){this._state!=="closed"&&(H(this),ie(this))}}class $e{constructor(t){this._subscription=t}get closed(){return this._subscription._state==="closed"}next(t){Y(this._subscription,"next",t)}error(t){Y(this._subscription,"error",t)}complete(){Y(this._subscription,"complete")}}class p{constructor(t){if(!(this instanceof p))throw new TypeError("Observable cannot be called as a function");if(typeof t!="function")throw new TypeError("Observable initializer must be a function");this._subscriber=t}subscribe(t,n,r){return(typeof t!="object"||t===null)&&(t={next:t,error:n,complete:r}),new ke(t,this._subscriber)}pipe(t,...n){let r=this;for(const s of[t,...n])r=s(r);return r}tap(t,n,r){const s=typeof t!="object"||t===null?{next:t,error:n,complete:r}:t;return new p(o=>this.subscribe({next(c){s.next&&s.next(c),o.next(c)},error(c){s.error&&s.error(c),o.error(c)},complete(){s.complete&&s.complete(),o.complete()},start(c){s.start&&s.start(c)}}))}forEach(t){return new Promise((n,r)=>{if(typeof t!="function"){r(new TypeError(t+" is not a function"));return}function s(){o.unsubscribe(),n(void 0)}const o=this.subscribe({next(c){try{t(c,s)}catch(a){r(a),o.unsubscribe()}},error(c){r(c)},complete(){n(void 0)}})})}map(t){if(typeof t!="function")throw new TypeError(t+" is not a function");const n=$(this);return new n(r=>this.subscribe({next(s){let o=s;try{o=t(s)}catch(c){return r.error(c)}r.next(o)},error(s){r.error(s)},complete(){r.complete()}}))}filter(t){if(typeof t!="function")throw new TypeError(t+" is not a function");const n=$(this);return new n(r=>this.subscribe({next(s){try{if(!t(s))return}catch(o){return r.error(o)}r.next(s)},error(s){r.error(s)},complete(){r.complete()}}))}reduce(t,n){if(typeof t!="function")throw new TypeError(t+" is not a function");const r=$(this),s=arguments.length>1;let o=!1,c=n;return new r(a=>this.subscribe({next(f){const l=!o;if(o=!0,!l||s)try{c=t(c,f)}catch(i){return a.error(i)}else c=f},error(f){a.error(f)},complete(){if(!o&&!s)return a.error(new TypeError("Cannot reduce an empty sequence"));a.next(c),a.complete()}}))}concat(...t){const n=$(this);return new n(r=>{let s,o=0;function c(a){s=a.subscribe({next(f){r.next(f)},error(f){r.error(f)},complete(){o===t.length?(s=void 0,r.complete()):c(n.from(t[o++]))}})}return c(this),()=>{s&&(s.unsubscribe(),s=void 0)}})}flatMap(t){if(typeof t!="function")throw new TypeError(t+" is not a function");const n=$(this);return new n(r=>{const s=[],o=this.subscribe({next(a){let f;if(t)try{f=t(a)}catch(i){return r.error(i)}else f=a;const l=n.from(f).subscribe({next(i){r.next(i)},error(i){r.error(i)},complete(){const i=s.indexOf(l);i>=0&&s.splice(i,1),c()}});s.push(l)},error(a){r.error(a)},complete(){c()}});function c(){o.closed&&s.length===0&&r.complete()}return()=>{s.forEach(a=>a.unsubscribe()),o.unsubscribe()}})}[Z](){return this}static from(t){const n=typeof this=="function"?this:p;if(t==null)throw new TypeError(t+" is not an object");const r=I(t,Z);if(r){const s=r.call(t);if(Object(s)!==s)throw new TypeError(s+" is not an object");return Te(s)&&s.constructor===n?s:new n(o=>s.subscribe(o))}if(k("iterator")){const s=I(t,je);if(s)return new n(o=>{R(()=>{if(!o.closed){for(const c of s.call(t))if(o.next(c),o.closed)return;o.complete()}})})}if(Array.isArray(t))return new n(s=>{R(()=>{if(!s.closed){for(const o of t)if(s.next(o),s.closed)return;s.complete()}})});throw new TypeError(t+" is not observable")}static of(...t){const n=typeof this=="function"?this:p;return new n(r=>{R(()=>{if(!r.closed){for(const s of t)if(r.next(s),r.closed)return;r.complete()}})})}static get[se](){return this}}oe()&&Object.defineProperty(p,Symbol("extensions"),{value:{symbol:Z,hostReportError:j},configurable:!0});function x(e){typeof e=="function"?e():e&&typeof e.unsubscribe=="function"&&e.unsubscribe()}var Pe=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function a(i){try{l(r.next(i))}catch(u){c(u)}}function f(i){try{l(r.throw(i))}catch(u){c(u)}}function l(i){i.done?o(i.value):s(i.value).then(a,f)}l((r=r.apply(e,t||[])).next())})};function Ae(e){return t=>new p(n=>{const r=new z(n),s=t.subscribe({complete(){r.complete()},error(o){r.error(o)},next(o){r.schedule(c=>Pe(this,void 0,void 0,function*(){(yield e(o))&&c(o)}))}});return()=>x(s)})}function ze(e){return e&&k("asyncIterator")&&e[Symbol.asyncIterator]}function Ie(e){return e&&k("iterator")&&e[Symbol.iterator]}var Re=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function a(i){try{l(r.next(i))}catch(u){c(u)}}function f(i){try{l(r.throw(i))}catch(u){c(u)}}function l(i){i.done?o(i.value):s(i.value).then(a,f)}l((r=r.apply(e,t||[])).next())})},qe=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=e[o]&&function(c){return new Promise(function(a,f){c=e[o](c),s(a,f,c.done,c.value)})}}function s(o,c,a,f){Promise.resolve(f).then(function(l){o({value:l,done:a})},c)}};function Ne(e){return t=>new p(n=>{const r=new z(n),s=t.subscribe({complete(){r.complete()},error(o){r.error(o)},next(o){r.schedule(c=>Re(this,void 0,void 0,function*(){var a,f;const l=yield e(o);if(Ie(l)||ze(l))try{for(var i=qe(l),u;u=yield i.next(),!u.done;){const d=u.value;c(d)}}catch(d){a={error:d}}finally{try{u&&!u.done&&(f=i.return)&&(yield f.call(i))}finally{if(a)throw a.error}}else l.map(d=>c(d))}))}});return()=>x(s)})}function Le(e){return new p(t=>{let n=0;const r=setInterval(()=>{t.next(n++)},e);return()=>clearInterval(r)})}var Je=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function a(i){try{l(r.next(i))}catch(u){c(u)}}function f(i){try{l(r.throw(i))}catch(u){c(u)}}function l(i){i.done?o(i.value):s(i.value).then(a,f)}l((r=r.apply(e,t||[])).next())})};function We(e){return t=>new p(n=>{const r=new z(n),s=t.subscribe({complete(){r.complete()},error(o){r.error(o)},next(o){r.schedule(c=>Je(this,void 0,void 0,function*(){const a=yield e(o);c(a)}))}});return()=>x(s)})}function ue(...e){return e.length===0?p.from([]):new p(t=>{let n=0;const r=e.map(o=>o.subscribe({error(c){t.error(c),s()},next(c){t.next(c)},complete(){++n===e.length&&(t.complete(),s())}})),s=()=>{r.forEach(o=>x(o))};return s})}class Ge extends p{constructor(){super(t=>(this._observers.add(t),()=>this._observers.delete(t))),this._observers=new Set}next(t){for(const n of this._observers)n.next(t)}error(t){for(const n of this._observers)n.error(t)}complete(){for(const t of this._observers)t.complete()}}var ae=Ge;function Ve(e){const t=new ae;let n,r=0;return new p(s=>{n||(n=e.subscribe(t));const o=t.subscribe(s);return r++,()=>{r--,o.unsubscribe(),r===0&&(x(n),n=void 0)}})}var Be=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function a(i){try{l(r.next(i))}catch(u){c(u)}}function f(i){try{l(r.throw(i))}catch(u){c(u)}}function l(i){i.done?o(i.value):s(i.value).then(a,f)}l((r=r.apply(e,t||[])).next())})};function Ze(e,t){return n=>new p(r=>{let s,o=0;const c=new z(r),a=n.subscribe({complete(){c.complete()},error(f){c.error(f)},next(f){c.schedule(l=>Be(this,void 0,void 0,function*(){s=yield e(o===0?typeof t>"u"?f:t:s,f,o++),l(s)}))}});return()=>x(a)})}var He=Object.freeze({__proto__:null,filter:Ae,flatMap:Ne,interval:Le,map:We,merge:ue,multicast:Ve,Observable:p,scan:Ze,Subject:ae,unsubscribe:x});const Ye=Symbol("thread.transferable");function Ke(e){return e&&typeof e=="object"&&e[Ye]}var q;(function(e){e.cancel="cancel",e.run="run"})(q||(q={}));var v;(function(e){e.error="error",e.init="init",e.result="result",e.running="running",e.uncaughtError="uncaughtError"})(v||(v={}));var Qe=e=>e?typeof Symbol.observable=="symbol"&&typeof e[Symbol.observable]=="function"?e===e[Symbol.observable]():typeof e["@@observable"]=="function"?e===e["@@observable"]():!1:!1,m={isWorkerRuntime:function(){const t=typeof self<"u"&&typeof Window<"u"&&self instanceof Window;return!!(typeof self<"u"&&self.postMessage&&!t)},postMessageToMaster:function(t,n){self.postMessage(t,n)},subscribeToMasterMessages:function(t){const n=s=>{t(s.data)},r=()=>{self.removeEventListener("message",n)};return self.addEventListener("message",n),r}},Xe=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function a(i){try{l(r.next(i))}catch(u){c(u)}}function f(i){try{l(r.throw(i))}catch(u){c(u)}}function l(i){i.done?o(i.value):s(i.value).then(a,f)}l((r=r.apply(e,t||[])).next())})};let fe=!1;const P=new Map,De=e=>e&&e.type===q.cancel,le=e=>e&&e.type===q.run,de=e=>Qe(e)||Ue(e);function Ue(e){return e&&typeof e=="object"&&typeof e.subscribe=="function"}function pe(e){return Ke(e)?{payload:e.send,transferables:e.transferables}:{payload:e,transferables:void 0}}function et(){const e={type:v.init,exposed:{type:"function"}};m.postMessageToMaster(e)}function tt(e){const t={type:v.init,exposed:{type:"module",methods:e}};m.postMessageToMaster(t)}function K(e,t){const{payload:n,transferables:r}=pe(t),s={type:v.error,uid:e,error:E(n)};m.postMessageToMaster(s,r)}function Q(e,t,n){const{payload:r,transferables:s}=pe(n),o={type:v.result,uid:e,complete:t?!0:void 0,payload:r};m.postMessageToMaster(o,s)}function nt(e,t){const n={type:v.running,uid:e,resultType:t};m.postMessageToMaster(n)}function N(e){try{const t={type:v.uncaughtError,error:E(e)};m.postMessageToMaster(t)}catch(t){console.error(`Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.
Latest error:`,t,`
Original error:`,e)}}function be(e,t,n){return Xe(this,void 0,void 0,function*(){let r;try{r=t(...n)}catch(o){return K(e,o)}const s=de(r)?"observable":"promise";if(nt(e,s),de(r)){const o=r.subscribe(c=>Q(e,!1,E(c)),c=>{K(e,E(c)),P.delete(e)},()=>{Q(e,!0),P.delete(e)});P.set(e,o)}else try{const o=yield r;Q(e,!0,E(o))}catch(o){K(e,E(o))}})}function rt(e){if(!m.isWorkerRuntime())throw Error("expose() called in the master thread.");if(fe)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(fe=!0,typeof e=="function")m.subscribeToMasterMessages(t=>{le(t)&&!t.method&&be(t.uid,e,t.args.map(te))}),et();else if(typeof e=="object"&&e){m.subscribeToMasterMessages(n=>{le(n)&&n.method&&be(n.uid,e[n.method],n.args.map(te))});const t=Object.keys(e).filter(n=>typeof e[n]=="function");tt(t)}else throw Error(`Invalid argument passed to expose(). Expected a function or an object, got: ${e}`);m.subscribeToMasterMessages(t=>{if(De(t)){const n=t.uid,r=P.get(n);r&&(r.unsubscribe(),P.delete(n))}})}typeof self<"u"&&typeof self.addEventListener=="function"&&m.isWorkerRuntime()&&(self.addEventListener("error",e=>{setTimeout(()=>N(e.error||e),250)}),self.addEventListener("unhandledrejection",e=>{const t=e.reason;t&&typeof t.message=="string"&&setTimeout(()=>N(t),250)})),typeof process<"u"&&typeof process.on=="function"&&m.isWorkerRuntime()&&(process.on("uncaughtException",e=>{setTimeout(()=>N(e),250)}),process.on("unhandledRejection",e=>{e&&typeof e.message=="string"&&setTimeout(()=>N(e),250)}));const ot=async(e=1e3)=>{await new Promise(t=>setTimeout(t,e))},X=()=>ot(1),D=async(e=2)=>{for(let t=0;t<.23*e*1e3;t++)await X()};var st=typeof global=="object"&&global&&global.Object===Object&&global,it=st,ct=typeof self=="object"&&self&&self.Object===Object&&self,ut=it||ct||Function("return this")(),at=ut,ft=at.Symbol,L=ft,ye=Object.prototype,lt=ye.hasOwnProperty,dt=ye.toString,A=L?L.toStringTag:void 0;function pt(e){var t=lt.call(e,A),n=e[A];try{e[A]=void 0;var r=!0}catch{}var s=dt.call(e);return r&&(t?e[A]=n:delete e[A]),s}var bt=Object.prototype,yt=bt.toString;function ht(e){return yt.call(e)}var mt="[object Null]",wt="[object Undefined]",he=L?L.toStringTag:void 0;function gt(e){return e==null?e===void 0?wt:mt:he&&he in Object(e)?pt(e):ht(e)}function Ct(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function _t(e){return e}var vt="[object AsyncFunction]",Ft="[object Function]",St="[object GeneratorFunction]",Mt="[object Proxy]";function xt(e){if(!Ct(e))return!1;var t=gt(e);return t==Ft||t==St||t==vt||t==Mt}function Et(e){return e===void 0}Promise.resolve();function me(e,t){function n(s){return{set(o,c,a){return o[Number(c)]=a,e.next([s,Number(c),a]),!0},get(o,c){const a=o[c];return xt(a)?a.bind(o):a}}}const r={};for(const s in t)r[s]=new Proxy(t[s],n(s)),e.next([s,Array.from(t[s])]);return r}var we={},jt=Fe(He);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Subject=e.Observable=void 0;const t=jt;Object.defineProperty(e,"Observable",{enumerable:!0,get:function(){return t.Observable}});const n=Symbol("observers");class r extends t.Observable{constructor(){super(o=>(this[n]=[...this[n]||[],o],()=>{this[n]=this[n].filter(a=>a!==o)})),this[n]=[]}complete(){this[n].forEach(o=>o.complete())}error(o){this[n].forEach(c=>c.error(o))}next(o){this[n].forEach(c=>c.next(o))}}e.Subject=r})(we);var ge=ve(we);const J=ge.Observable,W=ge.Subject,Tt=()=>({type:"pre"}),Ot=()=>({type:"post"}),kt=e=>({type:"lineno",payload:e}),$t=()=>({type:"ready"}),Ce=()=>({type:"running"}),Pt=()=>({type:"paused"}),At=()=>({type:"completed"});var zt=()=>{let e=!1,t=!1,n,r,s=0;const o=new W,c=new W,a=new W,f=new W,l=y=>f.next(y);function i(){e=!0,r=new Promise(y=>{n=()=>(e=!1,y(null))})}function u(){return[f,c,o]}function d(y,O,S){return a.next($t()),async(C,w,...M)=>{a.next(Ce()),await D(.2),await y(C,w,...M),c.next(Tt()),await S(),c.next(Ot()),await O(C,w,...M),c.next(At())}}async function g(){return e&&(l(`${s} is paused`),a.next(Pt()),await r),a.next(Ce()),null}async function T(y,O){a.next(kt(y)),t&&i(),await g()}function h(){t=!1}let b={};return{Demo:(y,O,S)=>({update(C){const[w,M,G]=C;b[w][M]=G},memory_msg(){return J.from(o)},core_msg(){return ue(J.from(c),J.from(a))},debug_msg(){return J.from(f)},resume(){if(e&&!Et(n))return l(`resume ${s}`),n(null);l("this cpu is not paused")},request_pause(){e?l("already paused"):(l("request_pause"),i())},enable_breakpoints(){t=!0},disable_breakpoints:h,async run(C,...w){l(`${C} starts running with args ${JSON.stringify(w)}`),s=C,b={...w.pop()};const M=await d(y,O,S)(u,C,...w,b);return l(`${C} completed`),h(),[M,C]}}),pause_stub:g,break_point:T}};const{Demo:It,break_point:_}=zt();function Rt(e,t,n,r){const s=n.filter((o,c)=>c!==e).map(o=>o<t).every(_t);return r[t]!=e||s}async function qt(e,t,n){const[r,,s]=e();r.next("lock received args: ",n);const{level:o,victim:c}=me(s,n);r.next("memory",o,c);for(let a=1;a<c.length;a++){await _(1),await _(2),o[t]=a,await _(3),c[a]=t,await _(4);do await _(100),await X(),await D(Math.random()*.5+.1);while(!Rt(t,a,o,c));await _(5),await X()}await _(6),await _(101)}async function Nt(e,t,n){const[r,,s]=e(),{level:o}=me(s,n);await _(7),o[t]=0,r.next("unlock"),await _(102)}rt(It(qt,Nt,D))})();
