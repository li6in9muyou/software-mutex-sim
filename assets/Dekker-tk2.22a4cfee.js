(function(){"use strict";const D={deserialize(e){return Object.assign(Error(e.message),{name:e.name,stack:e.stack})},serialize(e){return{__error_marker:"$$error",message:e.message,name:e.name,stack:e.stack}}},Se=e=>e&&typeof e=="object"&&"__error_marker"in e&&e.__error_marker==="$$error";let U={deserialize(e){return Se(e)?D.deserialize(e):e},serialize(e){return e instanceof Error?D.serialize(e):e}};function ee(e){return U.deserialize(e)}function E(e){return U.serialize(e)}function Me(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function xe(e){var t=e.default;if(typeof t=="function"){var n=function(){return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}),n}var te={exports:{}},V,ne;function Ee(){if(ne)return V;ne=1;var e=1e3,t=e*60,n=t*60,r=n*24,s=r*7,o=r*365.25;V=function(i,u){u=u||{};var d=typeof i;if(d==="string"&&i.length>0)return c(i);if(d==="number"&&isFinite(i))return u.long?a(i):f(i);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(i))};function c(i){if(i=String(i),!(i.length>100)){var u=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i);if(!!u){var d=parseFloat(u[1]),C=(u[2]||"ms").toLowerCase();switch(C){case"years":case"year":case"yrs":case"yr":case"y":return d*o;case"weeks":case"week":case"w":return d*s;case"days":case"day":case"d":return d*r;case"hours":case"hour":case"hrs":case"hr":case"h":return d*n;case"minutes":case"minute":case"mins":case"min":case"m":return d*t;case"seconds":case"second":case"secs":case"sec":case"s":return d*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return d;default:return}}}}function f(i){var u=Math.abs(i);return u>=r?Math.round(i/r)+"d":u>=n?Math.round(i/n)+"h":u>=t?Math.round(i/t)+"m":u>=e?Math.round(i/e)+"s":i+"ms"}function a(i){var u=Math.abs(i);return u>=r?l(i,u,r,"day"):u>=n?l(i,u,n,"hour"):u>=t?l(i,u,t,"minute"):u>=e?l(i,u,e,"second"):i+" ms"}function l(i,u,d,C){var j=u>=d*1.5;return Math.round(i/d)+" "+C+(j?"s":"")}return V}function Te(e){n.debug=n,n.default=n,n.coerce=a,n.disable=o,n.enable=s,n.enabled=c,n.humanize=Ee(),n.destroy=l,Object.keys(e).forEach(i=>{n[i]=e[i]}),n.names=[],n.skips=[],n.formatters={};function t(i){let u=0;for(let d=0;d<i.length;d++)u=(u<<5)-u+i.charCodeAt(d),u|=0;return n.colors[Math.abs(u)%n.colors.length]}n.selectColor=t;function n(i){let u,d=null,C,j;function m(...b){if(!m.enabled)return;const F=m,y=Number(new Date),O=y-(u||y);F.diff=O,F.prev=u,F.curr=y,u=y,b[0]=n.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let S=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(w,M)=>{if(w==="%%")return"%";S++;const G=n.formatters[M];if(typeof G=="function"){const Jt=b[S];w=G.call(F,Jt),b.splice(S,1),S--}return w}),n.formatArgs.call(F,b),(F.log||n.log).apply(F,b)}return m.namespace=i,m.useColors=n.useColors(),m.color=n.selectColor(i),m.extend=r,m.destroy=n.destroy,Object.defineProperty(m,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(C!==n.namespaces&&(C=n.namespaces,j=n.enabled(i)),j),set:b=>{d=b}}),typeof n.init=="function"&&n.init(m),m}function r(i,u){const d=n(this.namespace+(typeof u>"u"?":":u)+i);return d.log=this.log,d}function s(i){n.save(i),n.namespaces=i,n.names=[],n.skips=[];let u;const d=(typeof i=="string"?i:"").split(/[\s,]+/),C=d.length;for(u=0;u<C;u++)!d[u]||(i=d[u].replace(/\*/g,".*?"),i[0]==="-"?n.skips.push(new RegExp("^"+i.slice(1)+"$")):n.names.push(new RegExp("^"+i+"$")))}function o(){const i=[...n.names.map(f),...n.skips.map(f).map(u=>"-"+u)].join(",");return n.enable(""),i}function c(i){if(i[i.length-1]==="*")return!0;let u,d;for(u=0,d=n.skips.length;u<d;u++)if(n.skips[u].test(i))return!1;for(u=0,d=n.names.length;u<d;u++)if(n.names[u].test(i))return!0;return!1}function f(i){return i.toString().substring(2,i.toString().length-2).replace(/\.\*\?$/,"*")}function a(i){return i instanceof Error?i.stack||i.message:i}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var je=Te;(function(e,t){t.formatArgs=r,t.save=s,t.load=o,t.useColors=n,t.storage=c(),t.destroy=(()=>{let a=!1;return()=>{a||(a=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(a){if(a[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+a[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const l="color: "+this.color;a.splice(1,0,l,"color: inherit");let i=0,u=0;a[0].replace(/%[a-zA-Z%]/g,d=>{d!=="%%"&&(i++,d==="%c"&&(u=i))}),a.splice(u,0,l)}t.log=console.debug||console.log||(()=>{});function s(a){try{a?t.storage.setItem("debug",a):t.storage.removeItem("debug")}catch{}}function o(){let a;try{a=t.storage.getItem("debug")}catch{}return!a&&typeof process<"u"&&"env"in process&&(a=process.env.DEBUG),a}function c(){try{return localStorage}catch{}}e.exports=je(t);const{formatters:f}=e.exports;f.j=function(a){try{return JSON.stringify(a)}catch(l){return"[UnexpectedJSONParseError]: "+l.message}}})(te,te.exports);var Oe=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function f(i){try{l(r.next(i))}catch(u){c(u)}}function a(i){try{l(r.throw(i))}catch(u){c(u)}}function l(i){i.done?o(i.value):s(i.value).then(f,a)}l((r=r.apply(e,t||[])).next())})};class z{constructor(t){this._baseObserver=t,this._pendingPromises=new Set}complete(){Promise.all(this._pendingPromises).then(()=>this._baseObserver.complete()).catch(t=>this._baseObserver.error(t))}error(t){this._baseObserver.error(t)}schedule(t){const n=Promise.all(this._pendingPromises),r=[],s=c=>r.push(c),o=Promise.resolve().then(()=>Oe(this,void 0,void 0,function*(){yield n,yield t(s),this._pendingPromises.delete(o);for(const c of r)this._baseObserver.next(c)})).catch(c=>{this._pendingPromises.delete(o),this._baseObserver.error(c)});this._pendingPromises.add(o)}}const re=()=>typeof Symbol=="function",k=e=>re()&&Boolean(Symbol[e]),B=e=>k(e)?Symbol[e]:"@@"+e;k("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"));const ke=B("iterator"),Z=B("observable"),oe=B("species");function I(e,t){const n=e[t];if(n!=null){if(typeof n!="function")throw new TypeError(n+" is not a function");return n}}function $(e){let t=e.constructor;return t!==void 0&&(t=t[oe],t===null&&(t=void 0)),t!==void 0?t:p}function $e(e){return e instanceof p}function T(e){T.log?T.log(e):setTimeout(()=>{throw e},0)}function R(e){Promise.resolve().then(()=>{try{e()}catch(t){T(t)}})}function se(e){const t=e._cleanup;if(t!==void 0&&(e._cleanup=void 0,!!t))try{if(typeof t=="function")t();else{const n=I(t,"unsubscribe");n&&n.call(t)}}catch(n){T(n)}}function H(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function Pe(e){const t=e._queue;if(!!t){e._queue=void 0,e._state="ready";for(const n of t)if(ie(e,n.type,n.value),e._state==="closed")break}}function ie(e,t,n){e._state="running";const r=e._observer;try{const s=r?I(r,t):void 0;switch(t){case"next":s&&s.call(r,n);break;case"error":if(H(e),s)s.call(r,n);else throw n;break;case"complete":H(e),s&&s.call(r);break}}catch(s){T(s)}e._state==="closed"?se(e):e._state==="running"&&(e._state="ready")}function Y(e,t,n){if(e._state!=="closed"){if(e._state==="buffering"){e._queue=e._queue||[],e._queue.push({type:t,value:n});return}if(e._state!=="ready"){e._state="buffering",e._queue=[{type:t,value:n}],R(()=>Pe(e));return}ie(e,t,n)}}class Ae{constructor(t,n){this._cleanup=void 0,this._observer=t,this._queue=void 0,this._state="initializing";const r=new ze(this);try{this._cleanup=n.call(void 0,r)}catch(s){r.error(s)}this._state==="initializing"&&(this._state="ready")}get closed(){return this._state==="closed"}unsubscribe(){this._state!=="closed"&&(H(this),se(this))}}class ze{constructor(t){this._subscription=t}get closed(){return this._subscription._state==="closed"}next(t){Y(this._subscription,"next",t)}error(t){Y(this._subscription,"error",t)}complete(){Y(this._subscription,"complete")}}class p{constructor(t){if(!(this instanceof p))throw new TypeError("Observable cannot be called as a function");if(typeof t!="function")throw new TypeError("Observable initializer must be a function");this._subscriber=t}subscribe(t,n,r){return(typeof t!="object"||t===null)&&(t={next:t,error:n,complete:r}),new Ae(t,this._subscriber)}pipe(t,...n){let r=this;for(const s of[t,...n])r=s(r);return r}tap(t,n,r){const s=typeof t!="object"||t===null?{next:t,error:n,complete:r}:t;return new p(o=>this.subscribe({next(c){s.next&&s.next(c),o.next(c)},error(c){s.error&&s.error(c),o.error(c)},complete(){s.complete&&s.complete(),o.complete()},start(c){s.start&&s.start(c)}}))}forEach(t){return new Promise((n,r)=>{if(typeof t!="function"){r(new TypeError(t+" is not a function"));return}function s(){o.unsubscribe(),n(void 0)}const o=this.subscribe({next(c){try{t(c,s)}catch(f){r(f),o.unsubscribe()}},error(c){r(c)},complete(){n(void 0)}})})}map(t){if(typeof t!="function")throw new TypeError(t+" is not a function");const n=$(this);return new n(r=>this.subscribe({next(s){let o=s;try{o=t(s)}catch(c){return r.error(c)}r.next(o)},error(s){r.error(s)},complete(){r.complete()}}))}filter(t){if(typeof t!="function")throw new TypeError(t+" is not a function");const n=$(this);return new n(r=>this.subscribe({next(s){try{if(!t(s))return}catch(o){return r.error(o)}r.next(s)},error(s){r.error(s)},complete(){r.complete()}}))}reduce(t,n){if(typeof t!="function")throw new TypeError(t+" is not a function");const r=$(this),s=arguments.length>1;let o=!1,c=n;return new r(f=>this.subscribe({next(a){const l=!o;if(o=!0,!l||s)try{c=t(c,a)}catch(i){return f.error(i)}else c=a},error(a){f.error(a)},complete(){if(!o&&!s)return f.error(new TypeError("Cannot reduce an empty sequence"));f.next(c),f.complete()}}))}concat(...t){const n=$(this);return new n(r=>{let s,o=0;function c(f){s=f.subscribe({next(a){r.next(a)},error(a){r.error(a)},complete(){o===t.length?(s=void 0,r.complete()):c(n.from(t[o++]))}})}return c(this),()=>{s&&(s.unsubscribe(),s=void 0)}})}flatMap(t){if(typeof t!="function")throw new TypeError(t+" is not a function");const n=$(this);return new n(r=>{const s=[],o=this.subscribe({next(f){let a;if(t)try{a=t(f)}catch(i){return r.error(i)}else a=f;const l=n.from(a).subscribe({next(i){r.next(i)},error(i){r.error(i)},complete(){const i=s.indexOf(l);i>=0&&s.splice(i,1),c()}});s.push(l)},error(f){r.error(f)},complete(){c()}});function c(){o.closed&&s.length===0&&r.complete()}return()=>{s.forEach(f=>f.unsubscribe()),o.unsubscribe()}})}[Z](){return this}static from(t){const n=typeof this=="function"?this:p;if(t==null)throw new TypeError(t+" is not an object");const r=I(t,Z);if(r){const s=r.call(t);if(Object(s)!==s)throw new TypeError(s+" is not an object");return $e(s)&&s.constructor===n?s:new n(o=>s.subscribe(o))}if(k("iterator")){const s=I(t,ke);if(s)return new n(o=>{R(()=>{if(!o.closed){for(const c of s.call(t))if(o.next(c),o.closed)return;o.complete()}})})}if(Array.isArray(t))return new n(s=>{R(()=>{if(!s.closed){for(const o of t)if(s.next(o),s.closed)return;s.complete()}})});throw new TypeError(t+" is not observable")}static of(...t){const n=typeof this=="function"?this:p;return new n(r=>{R(()=>{if(!r.closed){for(const s of t)if(r.next(s),r.closed)return;r.complete()}})})}static get[oe](){return this}}re()&&Object.defineProperty(p,Symbol("extensions"),{value:{symbol:Z,hostReportError:T},configurable:!0});function x(e){typeof e=="function"?e():e&&typeof e.unsubscribe=="function"&&e.unsubscribe()}var Ie=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function f(i){try{l(r.next(i))}catch(u){c(u)}}function a(i){try{l(r.throw(i))}catch(u){c(u)}}function l(i){i.done?o(i.value):s(i.value).then(f,a)}l((r=r.apply(e,t||[])).next())})};function Re(e){return t=>new p(n=>{const r=new z(n),s=t.subscribe({complete(){r.complete()},error(o){r.error(o)},next(o){r.schedule(c=>Ie(this,void 0,void 0,function*(){(yield e(o))&&c(o)}))}});return()=>x(s)})}function qe(e){return e&&k("asyncIterator")&&e[Symbol.asyncIterator]}function Ne(e){return e&&k("iterator")&&e[Symbol.iterator]}var Le=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function f(i){try{l(r.next(i))}catch(u){c(u)}}function a(i){try{l(r.throw(i))}catch(u){c(u)}}function l(i){i.done?o(i.value):s(i.value).then(f,a)}l((r=r.apply(e,t||[])).next())})},Je=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=e[o]&&function(c){return new Promise(function(f,a){c=e[o](c),s(f,a,c.done,c.value)})}}function s(o,c,f,a){Promise.resolve(a).then(function(l){o({value:l,done:f})},c)}};function We(e){return t=>new p(n=>{const r=new z(n),s=t.subscribe({complete(){r.complete()},error(o){r.error(o)},next(o){r.schedule(c=>Le(this,void 0,void 0,function*(){var f,a;const l=yield e(o);if(Ne(l)||qe(l))try{for(var i=Je(l),u;u=yield i.next(),!u.done;){const d=u.value;c(d)}}catch(d){f={error:d}}finally{try{u&&!u.done&&(a=i.return)&&(yield a.call(i))}finally{if(f)throw f.error}}else l.map(d=>c(d))}))}});return()=>x(s)})}function Ge(e){return new p(t=>{let n=0;const r=setInterval(()=>{t.next(n++)},e);return()=>clearInterval(r)})}var Ve=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function f(i){try{l(r.next(i))}catch(u){c(u)}}function a(i){try{l(r.throw(i))}catch(u){c(u)}}function l(i){i.done?o(i.value):s(i.value).then(f,a)}l((r=r.apply(e,t||[])).next())})};function Be(e){return t=>new p(n=>{const r=new z(n),s=t.subscribe({complete(){r.complete()},error(o){r.error(o)},next(o){r.schedule(c=>Ve(this,void 0,void 0,function*(){const f=yield e(o);c(f)}))}});return()=>x(s)})}function ce(...e){return e.length===0?p.from([]):new p(t=>{let n=0;const r=e.map(o=>o.subscribe({error(c){t.error(c),s()},next(c){t.next(c)},complete(){++n===e.length&&(t.complete(),s())}})),s=()=>{r.forEach(o=>x(o))};return s})}class Ze extends p{constructor(){super(t=>(this._observers.add(t),()=>this._observers.delete(t))),this._observers=new Set}next(t){for(const n of this._observers)n.next(t)}error(t){for(const n of this._observers)n.error(t)}complete(){for(const t of this._observers)t.complete()}}var ue=Ze;function He(e){const t=new ue;let n,r=0;return new p(s=>{n||(n=e.subscribe(t));const o=t.subscribe(s);return r++,()=>{r--,o.unsubscribe(),r===0&&(x(n),n=void 0)}})}var Ye=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function f(i){try{l(r.next(i))}catch(u){c(u)}}function a(i){try{l(r.throw(i))}catch(u){c(u)}}function l(i){i.done?o(i.value):s(i.value).then(f,a)}l((r=r.apply(e,t||[])).next())})};function Ke(e,t){return n=>new p(r=>{let s,o=0;const c=new z(r),f=n.subscribe({complete(){c.complete()},error(a){c.error(a)},next(a){c.schedule(l=>Ye(this,void 0,void 0,function*(){s=yield e(o===0?typeof t>"u"?a:t:s,a,o++),l(s)}))}});return()=>x(f)})}var Qe=Object.freeze({__proto__:null,filter:Re,flatMap:We,interval:Ge,map:Be,merge:ce,multicast:He,Observable:p,scan:Ke,Subject:ue,unsubscribe:x});const Xe=Symbol("thread.transferable");function De(e){return e&&typeof e=="object"&&e[Xe]}var q;(function(e){e.cancel="cancel",e.run="run"})(q||(q={}));var v;(function(e){e.error="error",e.init="init",e.result="result",e.running="running",e.uncaughtError="uncaughtError"})(v||(v={}));var Ue=e=>e?typeof Symbol.observable=="symbol"&&typeof e[Symbol.observable]=="function"?e===e[Symbol.observable]():typeof e["@@observable"]=="function"?e===e["@@observable"]():!1:!1,h={isWorkerRuntime:function(){const t=typeof self<"u"&&typeof Window<"u"&&self instanceof Window;return!!(typeof self<"u"&&self.postMessage&&!t)},postMessageToMaster:function(t,n){self.postMessage(t,n)},subscribeToMasterMessages:function(t){const n=s=>{t(s.data)},r=()=>{self.removeEventListener("message",n)};return self.addEventListener("message",n),r}},et=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function f(i){try{l(r.next(i))}catch(u){c(u)}}function a(i){try{l(r.throw(i))}catch(u){c(u)}}function l(i){i.done?o(i.value):s(i.value).then(f,a)}l((r=r.apply(e,t||[])).next())})};let ae=!1;const P=new Map,tt=e=>e&&e.type===q.cancel,fe=e=>e&&e.type===q.run,le=e=>Ue(e)||nt(e);function nt(e){return e&&typeof e=="object"&&typeof e.subscribe=="function"}function de(e){return De(e)?{payload:e.send,transferables:e.transferables}:{payload:e,transferables:void 0}}function rt(){const e={type:v.init,exposed:{type:"function"}};h.postMessageToMaster(e)}function ot(e){const t={type:v.init,exposed:{type:"module",methods:e}};h.postMessageToMaster(t)}function K(e,t){const{payload:n,transferables:r}=de(t),s={type:v.error,uid:e,error:E(n)};h.postMessageToMaster(s,r)}function Q(e,t,n){const{payload:r,transferables:s}=de(n),o={type:v.result,uid:e,complete:t?!0:void 0,payload:r};h.postMessageToMaster(o,s)}function st(e,t){const n={type:v.running,uid:e,resultType:t};h.postMessageToMaster(n)}function N(e){try{const t={type:v.uncaughtError,error:E(e)};h.postMessageToMaster(t)}catch(t){console.error(`Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.
Latest error:`,t,`
Original error:`,e)}}function pe(e,t,n){return et(this,void 0,void 0,function*(){let r;try{r=t(...n)}catch(o){return K(e,o)}const s=le(r)?"observable":"promise";if(st(e,s),le(r)){const o=r.subscribe(c=>Q(e,!1,E(c)),c=>{K(e,E(c)),P.delete(e)},()=>{Q(e,!0),P.delete(e)});P.set(e,o)}else try{const o=yield r;Q(e,!0,E(o))}catch(o){K(e,E(o))}})}function it(e){if(!h.isWorkerRuntime())throw Error("expose() called in the master thread.");if(ae)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(ae=!0,typeof e=="function")h.subscribeToMasterMessages(t=>{fe(t)&&!t.method&&pe(t.uid,e,t.args.map(ee))}),rt();else if(typeof e=="object"&&e){h.subscribeToMasterMessages(n=>{fe(n)&&n.method&&pe(n.uid,e[n.method],n.args.map(ee))});const t=Object.keys(e).filter(n=>typeof e[n]=="function");ot(t)}else throw Error(`Invalid argument passed to expose(). Expected a function or an object, got: ${e}`);h.subscribeToMasterMessages(t=>{if(tt(t)){const n=t.uid,r=P.get(n);r&&(r.unsubscribe(),P.delete(n))}})}typeof self<"u"&&typeof self.addEventListener=="function"&&h.isWorkerRuntime()&&(self.addEventListener("error",e=>{setTimeout(()=>N(e.error||e),250)}),self.addEventListener("unhandledrejection",e=>{const t=e.reason;t&&typeof t.message=="string"&&setTimeout(()=>N(t),250)})),typeof process<"u"&&typeof process.on=="function"&&h.isWorkerRuntime()&&(process.on("uncaughtException",e=>{setTimeout(()=>N(e),250)}),process.on("unhandledRejection",e=>{e&&typeof e.message=="string"&&setTimeout(()=>N(e),250)}));var ct=typeof global=="object"&&global&&global.Object===Object&&global,ut=ct,at=typeof self=="object"&&self&&self.Object===Object&&self,ft=ut||at||Function("return this")(),lt=ft,dt=lt.Symbol,L=dt,be=Object.prototype,pt=be.hasOwnProperty,bt=be.toString,A=L?L.toStringTag:void 0;function yt(e){var t=pt.call(e,A),n=e[A];try{e[A]=void 0;var r=!0}catch{}var s=bt.call(e);return r&&(t?e[A]=n:delete e[A]),s}var mt=Object.prototype,ht=mt.toString;function wt(e){return ht.call(e)}var gt="[object Null]",Ct="[object Undefined]",ye=L?L.toStringTag:void 0;function _t(e){return e==null?e===void 0?Ct:gt:ye&&ye in Object(e)?yt(e):wt(e)}function vt(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ft="[object AsyncFunction]",St="[object Function]",Mt="[object GeneratorFunction]",xt="[object Proxy]";function Et(e){if(!vt(e))return!1;var t=_t(e);return t==St||t==Mt||t==Ft||t==xt}function Tt(e){return e===void 0}var me={},jt=xe(Qe);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Subject=e.Observable=void 0;const t=jt;Object.defineProperty(e,"Observable",{enumerable:!0,get:function(){return t.Observable}});const n=Symbol("observers");class r extends t.Observable{constructor(){super(o=>(this[n]=[...this[n]||[],o],()=>{this[n]=this[n].filter(f=>f!==o)})),this[n]=[]}complete(){this[n].forEach(o=>o.complete())}error(o){this[n].forEach(c=>c.error(o))}next(o){this[n].forEach(c=>c.next(o))}}e.Subject=r})(me);var he=Me(me);const J=he.Observable,W=he.Subject,Ot=()=>({type:"pre"}),kt=()=>({type:"post"}),$t=e=>({type:"lineno",payload:e}),Pt=()=>({type:"ready"}),we=()=>({type:"running"}),At=()=>({type:"paused"}),zt=()=>({type:"completed"}),It=async(e=1e3)=>{await new Promise(t=>setTimeout(t,e))},ge=()=>It(1),Ce=async(e=2)=>{for(let t=0;t<.23*e*1e3;t++)await ge()};var Rt=()=>{let e=!1,t=!1,n,r,s=0;const o=new W,c=new W,f=new W,a=new W,l=y=>a.next(y);function i(){e=!0,r=new Promise(y=>{n=()=>(e=!1,y(null))})}function u(){return[a,c,o]}function d(y,O,S){return f.next(Pt()),async(_,w,...M)=>{f.next(we()),await Ce(.2),await y(_,w,...M),c.next(Ot()),await S(),c.next(kt()),await O(_,w,...M),c.next(zt())}}async function C(){return e&&(l(`${s} is paused`),f.next(At()),await r),f.next(we()),null}async function j(y,O){f.next($t(y)),t&&i(),await C()}function m(){t=!1}let b={};return{Demo:(y,O,S)=>({update(_){const[w,M,G]=_;b[w][M]=G},memory_msg(){return J.from(o)},core_msg(){return ce(J.from(c),J.from(f))},debug_msg(){return J.from(a)},resume(){if(e&&!Tt(n))return l(`resume ${s}`),n(null);l("this cpu is not paused")},request_pause(){e?l("already paused"):(l("request_pause"),i())},enable_breakpoints(){t=!0},disable_breakpoints:m,async run(_,...w){l(`${_} starts running with args ${JSON.stringify(w)}`),s=_,b={...w.pop()};const M=await d(y,O,S)(u,_,...w,b);return l(`${_} completed`),m(),[M,_]}}),pause_stub:C,break_point:j}};const X=99,_e=-99;Promise.resolve();function ve(e,t){function n(s){return{set(o,c,f){return o[Number(c)]=f,e.next([s,Number(c),f]),!0},get(o,c){const f=o[c];return Et(f)?f.bind(o):f}}}const r={};for(const s in t)r[s]=new Proxy(t[s],n(s)),e.next([s,Array.from(t[s])]);return r}const{Demo:qt,break_point:g}=Rt();function Fe(e){return e===1?0:1}async function Nt(e,t,n){const[r,,s]=e();r.next("lock received args: ",n);const{wants_to_enter:o,turn:c}=ve(s,n);for(r.next("memory",o,c),await g(1),o[t]=X;X===o[Fe(t)];)if(await g(2),await g(4),c[0]!==t){for(await g(6),o[t]=_e,await g(7);c[0]!==t;)await g(8),await ge();await g(9),o[t]=X}await g(101)}async function Lt(e,t,n){const[r,,s]=e(),{turn:o,wants_to_enter:c}=ve(s,n);await g(51),c[t]=_e,await g(52),o[0]=Fe(t),r.next("unlock"),await g(102)}it(qt(Nt,Lt,Ce))})();
