(function(){"use strict";const U={deserialize(e){return Object.assign(Error(e.message),{name:e.name,stack:e.stack})},serialize(e){return{__error_marker:"$$error",message:e.message,name:e.name,stack:e.stack}}},Fe=e=>e&&typeof e=="object"&&"__error_marker"in e&&e.__error_marker==="$$error";let ee={deserialize(e){return Fe(e)?U.deserialize(e):e},serialize(e){return e instanceof Error?U.serialize(e):e}};function te(e){return ee.deserialize(e)}function E(e){return ee.serialize(e)}function Se(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Me(e){var t=e.default;if(typeof t=="function"){var n=function(){return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}),n}var ne={exports:{}},Z,re;function xe(){if(re)return Z;re=1;var e=1e3,t=e*60,n=t*60,r=n*24,s=r*7,o=r*365.25;Z=function(i,u){u=u||{};var d=typeof i;if(d==="string"&&i.length>0)return c(i);if(d==="number"&&isFinite(i))return u.long?a(i):l(i);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(i))};function c(i){if(i=String(i),!(i.length>100)){var u=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i);if(!!u){var d=parseFloat(u[1]),C=(u[2]||"ms").toLowerCase();switch(C){case"years":case"year":case"yrs":case"yr":case"y":return d*o;case"weeks":case"week":case"w":return d*s;case"days":case"day":case"d":return d*r;case"hours":case"hour":case"hrs":case"hr":case"h":return d*n;case"minutes":case"minute":case"mins":case"min":case"m":return d*t;case"seconds":case"second":case"secs":case"sec":case"s":return d*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return d;default:return}}}}function l(i){var u=Math.abs(i);return u>=r?Math.round(i/r)+"d":u>=n?Math.round(i/n)+"h":u>=t?Math.round(i/t)+"m":u>=e?Math.round(i/e)+"s":i+"ms"}function a(i){var u=Math.abs(i);return u>=r?f(i,u,r,"day"):u>=n?f(i,u,n,"hour"):u>=t?f(i,u,t,"minute"):u>=e?f(i,u,e,"second"):i+" ms"}function f(i,u,d,C){var T=u>=d*1.5;return Math.round(i/d)+" "+C+(T?"s":"")}return Z}function Ee(e){n.debug=n,n.default=n,n.coerce=a,n.disable=o,n.enable=s,n.enabled=c,n.humanize=xe(),n.destroy=f,Object.keys(e).forEach(i=>{n[i]=e[i]}),n.names=[],n.skips=[],n.formatters={};function t(i){let u=0;for(let d=0;d<i.length;d++)u=(u<<5)-u+i.charCodeAt(d),u|=0;return n.colors[Math.abs(u)%n.colors.length]}n.selectColor=t;function n(i){let u,d=null,C,T;function h(...b){if(!h.enabled)return;const F=h,y=Number(new Date),O=y-(u||y);F.diff=O,F.prev=u,F.curr=y,u=y,b[0]=n.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let S=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(g,M)=>{if(g==="%%")return"%";S++;const B=n.formatters[M];if(typeof B=="function"){const Jt=b[S];g=B.call(F,Jt),b.splice(S,1),S--}return g}),n.formatArgs.call(F,b),(F.log||n.log).apply(F,b)}return h.namespace=i,h.useColors=n.useColors(),h.color=n.selectColor(i),h.extend=r,h.destroy=n.destroy,Object.defineProperty(h,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(C!==n.namespaces&&(C=n.namespaces,T=n.enabled(i)),T),set:b=>{d=b}}),typeof n.init=="function"&&n.init(h),h}function r(i,u){const d=n(this.namespace+(typeof u>"u"?":":u)+i);return d.log=this.log,d}function s(i){n.save(i),n.namespaces=i,n.names=[],n.skips=[];let u;const d=(typeof i=="string"?i:"").split(/[\s,]+/),C=d.length;for(u=0;u<C;u++)!d[u]||(i=d[u].replace(/\*/g,".*?"),i[0]==="-"?n.skips.push(new RegExp("^"+i.slice(1)+"$")):n.names.push(new RegExp("^"+i+"$")))}function o(){const i=[...n.names.map(l),...n.skips.map(l).map(u=>"-"+u)].join(",");return n.enable(""),i}function c(i){if(i[i.length-1]==="*")return!0;let u,d;for(u=0,d=n.skips.length;u<d;u++)if(n.skips[u].test(i))return!1;for(u=0,d=n.names.length;u<d;u++)if(n.names[u].test(i))return!0;return!1}function l(i){return i.toString().substring(2,i.toString().length-2).replace(/\.\*\?$/,"*")}function a(i){return i instanceof Error?i.stack||i.message:i}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var je=Ee;(function(e,t){t.formatArgs=r,t.save=s,t.load=o,t.useColors=n,t.storage=c(),t.destroy=(()=>{let a=!1;return()=>{a||(a=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(a){if(a[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+a[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const f="color: "+this.color;a.splice(1,0,f,"color: inherit");let i=0,u=0;a[0].replace(/%[a-zA-Z%]/g,d=>{d!=="%%"&&(i++,d==="%c"&&(u=i))}),a.splice(u,0,f)}t.log=console.debug||console.log||(()=>{});function s(a){try{a?t.storage.setItem("debug",a):t.storage.removeItem("debug")}catch{}}function o(){let a;try{a=t.storage.getItem("debug")}catch{}return!a&&typeof process<"u"&&"env"in process&&(a=process.env.DEBUG),a}function c(){try{return localStorage}catch{}}e.exports=je(t);const{formatters:l}=e.exports;l.j=function(a){try{return JSON.stringify(a)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}}})(ne,ne.exports);var Te=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function l(i){try{f(r.next(i))}catch(u){c(u)}}function a(i){try{f(r.throw(i))}catch(u){c(u)}}function f(i){i.done?o(i.value):s(i.value).then(l,a)}f((r=r.apply(e,t||[])).next())})};class I{constructor(t){this._baseObserver=t,this._pendingPromises=new Set}complete(){Promise.all(this._pendingPromises).then(()=>this._baseObserver.complete()).catch(t=>this._baseObserver.error(t))}error(t){this._baseObserver.error(t)}schedule(t){const n=Promise.all(this._pendingPromises),r=[],s=c=>r.push(c),o=Promise.resolve().then(()=>Te(this,void 0,void 0,function*(){yield n,yield t(s),this._pendingPromises.delete(o);for(const c of r)this._baseObserver.next(c)})).catch(c=>{this._pendingPromises.delete(o),this._baseObserver.error(c)});this._pendingPromises.add(o)}}const oe=()=>typeof Symbol=="function",k=e=>oe()&&Boolean(Symbol[e]),H=e=>k(e)?Symbol[e]:"@@"+e;k("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"));const Oe=H("iterator"),Y=H("observable"),se=H("species");function z(e,t){const n=e[t];if(n!=null){if(typeof n!="function")throw new TypeError(n+" is not a function");return n}}function $(e){let t=e.constructor;return t!==void 0&&(t=t[se],t===null&&(t=void 0)),t!==void 0?t:p}function ke(e){return e instanceof p}function j(e){j.log?j.log(e):setTimeout(()=>{throw e},0)}function N(e){Promise.resolve().then(()=>{try{e()}catch(t){j(t)}})}function ie(e){const t=e._cleanup;if(t!==void 0&&(e._cleanup=void 0,!!t))try{if(typeof t=="function")t();else{const n=z(t,"unsubscribe");n&&n.call(t)}}catch(n){j(n)}}function K(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function $e(e){const t=e._queue;if(!!t){e._queue=void 0,e._state="ready";for(const n of t)if(ce(e,n.type,n.value),e._state==="closed")break}}function ce(e,t,n){e._state="running";const r=e._observer;try{const s=r?z(r,t):void 0;switch(t){case"next":s&&s.call(r,n);break;case"error":if(K(e),s)s.call(r,n);else throw n;break;case"complete":K(e),s&&s.call(r);break}}catch(s){j(s)}e._state==="closed"?ie(e):e._state==="running"&&(e._state="ready")}function Q(e,t,n){if(e._state!=="closed"){if(e._state==="buffering"){e._queue=e._queue||[],e._queue.push({type:t,value:n});return}if(e._state!=="ready"){e._state="buffering",e._queue=[{type:t,value:n}],N(()=>$e(e));return}ce(e,t,n)}}class Pe{constructor(t,n){this._cleanup=void 0,this._observer=t,this._queue=void 0,this._state="initializing";const r=new Ae(this);try{this._cleanup=n.call(void 0,r)}catch(s){r.error(s)}this._state==="initializing"&&(this._state="ready")}get closed(){return this._state==="closed"}unsubscribe(){this._state!=="closed"&&(K(this),ie(this))}}class Ae{constructor(t){this._subscription=t}get closed(){return this._subscription._state==="closed"}next(t){Q(this._subscription,"next",t)}error(t){Q(this._subscription,"error",t)}complete(){Q(this._subscription,"complete")}}class p{constructor(t){if(!(this instanceof p))throw new TypeError("Observable cannot be called as a function");if(typeof t!="function")throw new TypeError("Observable initializer must be a function");this._subscriber=t}subscribe(t,n,r){return(typeof t!="object"||t===null)&&(t={next:t,error:n,complete:r}),new Pe(t,this._subscriber)}pipe(t,...n){let r=this;for(const s of[t,...n])r=s(r);return r}tap(t,n,r){const s=typeof t!="object"||t===null?{next:t,error:n,complete:r}:t;return new p(o=>this.subscribe({next(c){s.next&&s.next(c),o.next(c)},error(c){s.error&&s.error(c),o.error(c)},complete(){s.complete&&s.complete(),o.complete()},start(c){s.start&&s.start(c)}}))}forEach(t){return new Promise((n,r)=>{if(typeof t!="function"){r(new TypeError(t+" is not a function"));return}function s(){o.unsubscribe(),n(void 0)}const o=this.subscribe({next(c){try{t(c,s)}catch(l){r(l),o.unsubscribe()}},error(c){r(c)},complete(){n(void 0)}})})}map(t){if(typeof t!="function")throw new TypeError(t+" is not a function");const n=$(this);return new n(r=>this.subscribe({next(s){let o=s;try{o=t(s)}catch(c){return r.error(c)}r.next(o)},error(s){r.error(s)},complete(){r.complete()}}))}filter(t){if(typeof t!="function")throw new TypeError(t+" is not a function");const n=$(this);return new n(r=>this.subscribe({next(s){try{if(!t(s))return}catch(o){return r.error(o)}r.next(s)},error(s){r.error(s)},complete(){r.complete()}}))}reduce(t,n){if(typeof t!="function")throw new TypeError(t+" is not a function");const r=$(this),s=arguments.length>1;let o=!1,c=n;return new r(l=>this.subscribe({next(a){const f=!o;if(o=!0,!f||s)try{c=t(c,a)}catch(i){return l.error(i)}else c=a},error(a){l.error(a)},complete(){if(!o&&!s)return l.error(new TypeError("Cannot reduce an empty sequence"));l.next(c),l.complete()}}))}concat(...t){const n=$(this);return new n(r=>{let s,o=0;function c(l){s=l.subscribe({next(a){r.next(a)},error(a){r.error(a)},complete(){o===t.length?(s=void 0,r.complete()):c(n.from(t[o++]))}})}return c(this),()=>{s&&(s.unsubscribe(),s=void 0)}})}flatMap(t){if(typeof t!="function")throw new TypeError(t+" is not a function");const n=$(this);return new n(r=>{const s=[],o=this.subscribe({next(l){let a;if(t)try{a=t(l)}catch(i){return r.error(i)}else a=l;const f=n.from(a).subscribe({next(i){r.next(i)},error(i){r.error(i)},complete(){const i=s.indexOf(f);i>=0&&s.splice(i,1),c()}});s.push(f)},error(l){r.error(l)},complete(){c()}});function c(){o.closed&&s.length===0&&r.complete()}return()=>{s.forEach(l=>l.unsubscribe()),o.unsubscribe()}})}[Y](){return this}static from(t){const n=typeof this=="function"?this:p;if(t==null)throw new TypeError(t+" is not an object");const r=z(t,Y);if(r){const s=r.call(t);if(Object(s)!==s)throw new TypeError(s+" is not an object");return ke(s)&&s.constructor===n?s:new n(o=>s.subscribe(o))}if(k("iterator")){const s=z(t,Oe);if(s)return new n(o=>{N(()=>{if(!o.closed){for(const c of s.call(t))if(o.next(c),o.closed)return;o.complete()}})})}if(Array.isArray(t))return new n(s=>{N(()=>{if(!s.closed){for(const o of t)if(s.next(o),s.closed)return;s.complete()}})});throw new TypeError(t+" is not observable")}static of(...t){const n=typeof this=="function"?this:p;return new n(r=>{N(()=>{if(!r.closed){for(const s of t)if(r.next(s),r.closed)return;r.complete()}})})}static get[se](){return this}}oe()&&Object.defineProperty(p,Symbol("extensions"),{value:{symbol:Y,hostReportError:j},configurable:!0});function x(e){typeof e=="function"?e():e&&typeof e.unsubscribe=="function"&&e.unsubscribe()}var Ie=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function l(i){try{f(r.next(i))}catch(u){c(u)}}function a(i){try{f(r.throw(i))}catch(u){c(u)}}function f(i){i.done?o(i.value):s(i.value).then(l,a)}f((r=r.apply(e,t||[])).next())})};function ze(e){return t=>new p(n=>{const r=new I(n),s=t.subscribe({complete(){r.complete()},error(o){r.error(o)},next(o){r.schedule(c=>Ie(this,void 0,void 0,function*(){(yield e(o))&&c(o)}))}});return()=>x(s)})}function Ne(e){return e&&k("asyncIterator")&&e[Symbol.asyncIterator]}function Re(e){return e&&k("iterator")&&e[Symbol.iterator]}var qe=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function l(i){try{f(r.next(i))}catch(u){c(u)}}function a(i){try{f(r.throw(i))}catch(u){c(u)}}function f(i){i.done?o(i.value):s(i.value).then(l,a)}f((r=r.apply(e,t||[])).next())})},Le=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=e[o]&&function(c){return new Promise(function(l,a){c=e[o](c),s(l,a,c.done,c.value)})}}function s(o,c,l,a){Promise.resolve(a).then(function(f){o({value:f,done:l})},c)}};function Je(e){return t=>new p(n=>{const r=new I(n),s=t.subscribe({complete(){r.complete()},error(o){r.error(o)},next(o){r.schedule(c=>qe(this,void 0,void 0,function*(){var l,a;const f=yield e(o);if(Re(f)||Ne(f))try{for(var i=Le(f),u;u=yield i.next(),!u.done;){const d=u.value;c(d)}}catch(d){l={error:d}}finally{try{u&&!u.done&&(a=i.return)&&(yield a.call(i))}finally{if(l)throw l.error}}else f.map(d=>c(d))}))}});return()=>x(s)})}function We(e){return new p(t=>{let n=0;const r=setInterval(()=>{t.next(n++)},e);return()=>clearInterval(r)})}var Ge=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function l(i){try{f(r.next(i))}catch(u){c(u)}}function a(i){try{f(r.throw(i))}catch(u){c(u)}}function f(i){i.done?o(i.value):s(i.value).then(l,a)}f((r=r.apply(e,t||[])).next())})};function Ve(e){return t=>new p(n=>{const r=new I(n),s=t.subscribe({complete(){r.complete()},error(o){r.error(o)},next(o){r.schedule(c=>Ge(this,void 0,void 0,function*(){const l=yield e(o);c(l)}))}});return()=>x(s)})}function ue(...e){return e.length===0?p.from([]):new p(t=>{let n=0;const r=e.map(o=>o.subscribe({error(c){t.error(c),s()},next(c){t.next(c)},complete(){++n===e.length&&(t.complete(),s())}})),s=()=>{r.forEach(o=>x(o))};return s})}class Be extends p{constructor(){super(t=>(this._observers.add(t),()=>this._observers.delete(t))),this._observers=new Set}next(t){for(const n of this._observers)n.next(t)}error(t){for(const n of this._observers)n.error(t)}complete(){for(const t of this._observers)t.complete()}}var ae=Be;function Ze(e){const t=new ae;let n,r=0;return new p(s=>{n||(n=e.subscribe(t));const o=t.subscribe(s);return r++,()=>{r--,o.unsubscribe(),r===0&&(x(n),n=void 0)}})}var He=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function l(i){try{f(r.next(i))}catch(u){c(u)}}function a(i){try{f(r.throw(i))}catch(u){c(u)}}function f(i){i.done?o(i.value):s(i.value).then(l,a)}f((r=r.apply(e,t||[])).next())})};function Ye(e,t){return n=>new p(r=>{let s,o=0;const c=new I(r),l=n.subscribe({complete(){c.complete()},error(a){c.error(a)},next(a){c.schedule(f=>He(this,void 0,void 0,function*(){s=yield e(o===0?typeof t>"u"?a:t:s,a,o++),f(s)}))}});return()=>x(l)})}var Ke=Object.freeze({__proto__:null,filter:ze,flatMap:Je,interval:We,map:Ve,merge:ue,multicast:Ze,Observable:p,scan:Ye,Subject:ae,unsubscribe:x});const Qe=Symbol("thread.transferable");function Xe(e){return e&&typeof e=="object"&&e[Qe]}var R;(function(e){e.cancel="cancel",e.run="run"})(R||(R={}));var v;(function(e){e.error="error",e.init="init",e.result="result",e.running="running",e.uncaughtError="uncaughtError"})(v||(v={}));var De=e=>e?typeof Symbol.observable=="symbol"&&typeof e[Symbol.observable]=="function"?e===e[Symbol.observable]():typeof e["@@observable"]=="function"?e===e["@@observable"]():!1:!1,m={isWorkerRuntime:function(){const t=typeof self<"u"&&typeof Window<"u"&&self instanceof Window;return!!(typeof self<"u"&&self.postMessage&&!t)},postMessageToMaster:function(t,n){self.postMessage(t,n)},subscribeToMasterMessages:function(t){const n=s=>{t(s.data)},r=()=>{self.removeEventListener("message",n)};return self.addEventListener("message",n),r}},Ue=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function l(i){try{f(r.next(i))}catch(u){c(u)}}function a(i){try{f(r.throw(i))}catch(u){c(u)}}function f(i){i.done?o(i.value):s(i.value).then(l,a)}f((r=r.apply(e,t||[])).next())})};let fe=!1;const P=new Map,et=e=>e&&e.type===R.cancel,le=e=>e&&e.type===R.run,de=e=>De(e)||tt(e);function tt(e){return e&&typeof e=="object"&&typeof e.subscribe=="function"}function pe(e){return Xe(e)?{payload:e.send,transferables:e.transferables}:{payload:e,transferables:void 0}}function nt(){const e={type:v.init,exposed:{type:"function"}};m.postMessageToMaster(e)}function rt(e){const t={type:v.init,exposed:{type:"module",methods:e}};m.postMessageToMaster(t)}function X(e,t){const{payload:n,transferables:r}=pe(t),s={type:v.error,uid:e,error:E(n)};m.postMessageToMaster(s,r)}function D(e,t,n){const{payload:r,transferables:s}=pe(n),o={type:v.result,uid:e,complete:t?!0:void 0,payload:r};m.postMessageToMaster(o,s)}function ot(e,t){const n={type:v.running,uid:e,resultType:t};m.postMessageToMaster(n)}function q(e){try{const t={type:v.uncaughtError,error:E(e)};m.postMessageToMaster(t)}catch(t){console.error(`Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.
Latest error:`,t,`
Original error:`,e)}}function be(e,t,n){return Ue(this,void 0,void 0,function*(){let r;try{r=t(...n)}catch(o){return X(e,o)}const s=de(r)?"observable":"promise";if(ot(e,s),de(r)){const o=r.subscribe(c=>D(e,!1,E(c)),c=>{X(e,E(c)),P.delete(e)},()=>{D(e,!0),P.delete(e)});P.set(e,o)}else try{const o=yield r;D(e,!0,E(o))}catch(o){X(e,E(o))}})}function st(e){if(!m.isWorkerRuntime())throw Error("expose() called in the master thread.");if(fe)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(fe=!0,typeof e=="function")m.subscribeToMasterMessages(t=>{le(t)&&!t.method&&be(t.uid,e,t.args.map(te))}),nt();else if(typeof e=="object"&&e){m.subscribeToMasterMessages(n=>{le(n)&&n.method&&be(n.uid,e[n.method],n.args.map(te))});const t=Object.keys(e).filter(n=>typeof e[n]=="function");rt(t)}else throw Error(`Invalid argument passed to expose(). Expected a function or an object, got: ${e}`);m.subscribeToMasterMessages(t=>{if(et(t)){const n=t.uid,r=P.get(n);r&&(r.unsubscribe(),P.delete(n))}})}typeof self<"u"&&typeof self.addEventListener=="function"&&m.isWorkerRuntime()&&(self.addEventListener("error",e=>{setTimeout(()=>q(e.error||e),250)}),self.addEventListener("unhandledrejection",e=>{const t=e.reason;t&&typeof t.message=="string"&&setTimeout(()=>q(t),250)})),typeof process<"u"&&typeof process.on=="function"&&m.isWorkerRuntime()&&(process.on("uncaughtException",e=>{setTimeout(()=>q(e),250)}),process.on("unhandledRejection",e=>{e&&typeof e.message=="string"&&setTimeout(()=>q(e),250)}));var it=typeof global=="object"&&global&&global.Object===Object&&global,ct=it,ut=typeof self=="object"&&self&&self.Object===Object&&self,at=ct||ut||Function("return this")(),ft=at,lt=ft.Symbol,L=lt,ye=Object.prototype,dt=ye.hasOwnProperty,pt=ye.toString,A=L?L.toStringTag:void 0;function bt(e){var t=dt.call(e,A),n=e[A];try{e[A]=void 0;var r=!0}catch{}var s=pt.call(e);return r&&(t?e[A]=n:delete e[A]),s}var yt=Object.prototype,ht=yt.toString;function mt(e){return ht.call(e)}var wt="[object Null]",gt="[object Undefined]",he=L?L.toStringTag:void 0;function Ct(e){return e==null?e===void 0?gt:wt:he&&he in Object(e)?bt(e):mt(e)}function _t(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var vt="[object AsyncFunction]",Ft="[object Function]",St="[object GeneratorFunction]",Mt="[object Proxy]";function xt(e){if(!_t(e))return!1;var t=Ct(e);return t==Ft||t==St||t==vt||t==Mt}function Et(e){return e===void 0}var me={},jt=Me(Ke);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Subject=e.Observable=void 0;const t=jt;Object.defineProperty(e,"Observable",{enumerable:!0,get:function(){return t.Observable}});const n=Symbol("observers");class r extends t.Observable{constructor(){super(o=>(this[n]=[...this[n]||[],o],()=>{this[n]=this[n].filter(l=>l!==o)})),this[n]=[]}complete(){this[n].forEach(o=>o.complete())}error(o){this[n].forEach(c=>c.error(o))}next(o){this[n].forEach(c=>c.next(o))}}e.Subject=r})(me);var we=Se(me);const J=we.Observable,W=we.Subject,Tt=()=>({type:"pre"}),Ot=()=>({type:"post"}),kt=e=>({type:"lineno",payload:e}),$t=()=>({type:"ready"}),ge=()=>({type:"running"}),Pt=()=>({type:"paused"}),At=()=>({type:"completed"}),It=async(e=1e3)=>{await new Promise(t=>setTimeout(t,e))},G=()=>It(1),Ce=async(e=2)=>{for(let t=0;t<.23*e*1e3;t++)await G()};var zt=()=>{let e=!1,t=!1,n,r,s=0;const o=new W,c=new W,l=new W,a=new W,f=y=>a.next(y);function i(){e=!0,r=new Promise(y=>{n=()=>(e=!1,y(null))})}function u(){return[a,c,o]}function d(y,O,S){return l.next($t()),async(_,g,...M)=>{l.next(ge()),await Ce(.2),await y(_,g,...M),c.next(Tt()),await S(),c.next(Ot()),await O(_,g,...M),c.next(At())}}async function C(){return e&&(f(`${s} is paused`),l.next(Pt()),await r),l.next(ge()),null}async function T(y,O){l.next(kt(y)),t&&i(),await C()}function h(){t=!1}let b={};return{Demo:(y,O,S)=>({update(_){const[g,M,B]=_;b[g][M]=B},memory_msg(){return J.from(o)},core_msg(){return ue(J.from(c),J.from(l))},debug_msg(){return J.from(a)},resume(){if(e&&!Et(n))return f(`resume ${s}`),n(null);f("this cpu is not paused")},request_pause(){e?f("already paused"):(f("request_pause"),i())},enable_breakpoints(){t=!0},disable_breakpoints:h,async run(_,...g){f(`${_} starts running with args ${JSON.stringify(g)}`),s=_,b={...g.pop()};const M=await d(y,O,S)(u,_,...g,b);return f(`${_} completed`),h(),[M,_]}}),pause_stub:C,break_point:T}};const V=13,_e=99,Nt=42;Promise.resolve();function ve(e,t){function n(s){return{set(o,c,l){return o[Number(c)]=l,e.next([s,Number(c),l]),!0},get(o,c){const l=o[c];return xt(l)?l.bind(o):l}}}const r={};for(const s in t)r[s]=new Proxy(t[s],n(s)),e.next([s,Array.from(t[s])]);return r}const{Demo:Rt,break_point:w}=zt();async function qt(e,t,n){const[r,,s]=e();r.next("lock received args: ",n);const{flag:o,turn:c}=ve(s,n);r.next("memory",o,c);const l=o.length,a=t;let f;do{for(await w(3),o[a]=Nt,f=c[0];f!=a;)await w(5),await G(),o[f]!=V?f=c[0]:(f+=1,f%=l);for(await w(13),o[a]=_e,await w(14),f=0;f<l&&(f===a||o[f]!==_e);)f+=1;if(await w(18),f>=l&&(c[0]==a||o[c[0]]==V))break;await G()}while(!0);await w(22),c[0]=a,await w(101)}async function Lt(e,t,n){const[r,,s]=e(),{flag:o,turn:c}=ve(s,n),l=o.length;await w(50);let a=(c[0]+1)%l;for(;a+=1,a%=l,await w(54),await G(),o[a]===V;);await w(58),c[0]=a,await w(59),o[t]=V,r.next("unlock"),await w(102)}st(Rt(qt,Lt,Ce))})();
